%% ------------------------------AULAS--------------------------
aula(nh101, 50, 10).
aula(nh201, 50, 10).
aula(nh301, 50, 10).
aula(m2001, 30, 5).
aula(etaa2, 30, 5).
aula(etb101, 20, 5).
aula(hkd101, 80, 20).
aula(zbr101, 40, 15).
aula(prg101, 45, 25).
aula(prg201, 35, 10).

%% -----------------------------ESTUDIANTES---------------------
%10
estudiante(2000100001, 1, [math101, phys201, ec201]) .
estudiante(2000100002, 1, [math101, phys201, hist301]).
estudiante(2000100003, 1, [math101, ec201, hist301]) .
estudiante(2000100004, 1, [math101, phys201, ec201, hist301]) .
estudiante(2000100007, 0, [ec201, phys201]).
estudiante(2000100015, 0, [ec201, hist301]) .
estudiante(2000100016, 0, [cmpe150, hist301]).
estudiante(2000100017, 0, [math301, bd101]).
estudiante(2000100008, 0, [math101, phys201]) .
estudiante(2000100009, 1, [phys201, ec201]).
%%20
estudiante(2000100010, 0, [cmpe150, math101]).
estudiante(2000100011, 0, [cmpe150, hist301]).
estudiante(2000100012, 1, [math101, phys201]).
estudiante(2002100009, 0, [math101, ec201, hist301]).
estudiante(2002100071, 0, [phys201, ec201, hist301]).
estudiante(2002100053, 0, [cmpe150, ec201]).
estudiante(2002100040, 1, [math101, hist301]).
estudiante(2002100032, 0, [phys201, ec201]).
estudiante(2002100010, 0, [cmpe150]).
estudiante(2002103010, 1, [math101, phis101, quim101]).
%%30
estudiante(2000100100, 1, [math401]).
estudiante(2000100101, 1, [math401, phis101, ec201]).
estudiante(2000100102, 1, [cmpe150, math101, phys201, ec201, hist301]).
estudiante(2000100103, 1, [moda101, hist301, soci101]).
estudiante(2000100104, 1, [ofi301, math401]).
estudiante(2000100105, 1, [phis201, quim101]).
estudiante(2000100106, 1, [hist301, soci101, math201]).
estudiante(2000100107, 1, [leng201, ofi101, cmpe150, math101]).
estudiante(2000100108, 1, [bd101, leng101, phis201, quim101]).
estudiante(2000100109, 0, [quim201, ofi301, math401]).
%%40
estudiante(2000100200, 1, [phys201, ec201, hist301]).
estudiante(2000100201, 0, [hist301, soci101, math101, cmpe150, ofi101]).
estudiante(2000100202, 1, [ec201, hist301]).
estudiante(2000100203, 0, [math401, quim201]).
estudiante(2000100204, 1, [moda101, ec201, hist301]).
estudiante(2000100205, 1, [ec201, hist301]).
estudiante(2000100206, 1, [ofi101, moda101]).
estudiante(2000100207, 1, [math301, bd101]).
estudiante(2000100208, 1, [ofi301, math401, phis101]).
estudiante(2000100209, 1, [leng201, ofi101]).
%%50
estudiante(2000100300, 0, [math301, bd101, cmpe150, leng101, ofi101]).
estudiante(2000100301, 0, [quim201]).
estudiante(2000100302, 1, [quim101, math301, bd101]).
estudiante(2000100303, 1, [quim201, soci101, math201]).
estudiante(2000100304, 1, [leng201, ofi201, math201]).
estudiante(2000100305, 0, [phys201, ec201, leng201, ofi101]).
estudiante(2000100306, 1, [math401, phis101]).
estudiante(2000100307, 1, [math201]).
estudiante(2000100308, 0, [math201, hist301, soci101]).
estudiante(2000100309, 1, [ofi301, math401, phis101, soci101]).
%%60
estudiante(2000100400, 1, [phis201, quim101]).
estudiante(2000100401, 1, [math301, bd101,cmpe150, ofi301]).
estudiante(2000100402, 1, [ec201, hist301]).
estudiante(2000100403, 1, [hist301, soci101, math201]).
estudiante(2000100404, 1, [cmpe150, math101, ofi101]).
estudiante(2000100405, 1, [leng101, ofi201, cmpe150]).
estudiante(2000100406, 0, [math401, phis101]).
estudiante(2000100407, 1, [phis101, math401, moda101]).
estudiante(2000100408, 1, [ofi301, math401, phis101]).
estudiante(2000100409, 1, [ec201, hist301]).
%%70
estudiante(2000100500, 1, [quim201, bd101]).
estudiante(2000100501, 0, [ofi301, math401, phis101, ec201]).
estudiante(2000100502, 1, [phys201, ec201, hist301]).
estudiante(2000100503, 0, [ec201, hist301, soci101]).
estudiante(2000100504, 0, [soci101, math201, phis201]).
estudiante(2000100505, 1, [ec201, hist301]).
estudiante(2000100506, 1, [math201, phis201]).
estudiante(2000100507, 1, [phis201, moda101, ofi201]).
estudiante(2000100508, 1, [hist301, soci101]).
estudiante(2000100509, 1, [ofi301, math401, phis101]).
%%80
estudiante(2000100600, 1, [ofi301, math401]).
estudiante(2000100601, 0, [moda101, ofi201, cmpe150, math101]).
estudiante(2000100602, 1, [ofi101, quim101, cmpe150]).
estudiante(2000100603, 1, [math401, cmpe150, phis101]).
estudiante(2000100604, 1, [leng201, ofi101, quim101]).
estudiante(2000100605, 1, [leng101, cmpe150, math401]).
estudiante(2000100606, 1, [ec201, bd101, soci101]).
estudiante(2000100607, 1, [soci101, phis201, moda101]).
estudiante(2000100608, 1, [math101, moda101, ofi301]).
estudiante(2000100609, 1, [leng101, ofi201, cmpe150]).
%%90
estudiante(2000100700, 1, [ec201, hist301]).
estudiante(2000100701, 0, [ofi301, math401, phis101]).
estudiante(2000100702, 0, [hist301, soci101, math201]).
estudiante(2000100703, 0, [math401, phis201]).
estudiante(2000100704, 0, [ofi301, math401]).
estudiante(2000100705, 1, [math101, phys201, ec201, hist301, soci101]).
estudiante(2000100706, 1, [phys201, ec201, hist301, soci101]).
estudiante(2000100707, 1, [leng101, phys201]).
estudiante(2000100708, 1, [math101, leng101, phys201]).
estudiante(2000100709, 1, [math301, quim201, bd101]).
%%100
estudiante(2000100800, 1, [moda101, leng101]).
estudiante(2000100801, 1, [math301, quim201, bd101]).
estudiante(2000100802, 1, [phys201, ec201, hist301]).
estudiante(2000100803, 1, [cmpe150, math101, leng101, phys201]).
estudiante(2000100804, 1, [phis101, math301, quim201, bd101]).
estudiante(2000100805, 1, [phis201, moda101]).
estudiante(2000100806, 1, [phys201, ec201, hist301, soci101]).
estudiante(2000100807, 1, [ofi301, math401, phis101]).
estudiante(2000100808, 1, [cmpe150, ofi301, math401, phis101]).
estudiante(2000100809, 0, [hist301, soci101, math201]).
%%110
estudiante(2000100900, 0, [leng101, ofi201, cmpe150]).
estudiante(2000100901, 1, [leng201, ofi101, quim101, cmpe150]).
estudiante(2000100902, 1, [math101, moda101, leng101, cmpe150]).
estudiante(2000100903, 1, [math401, phis101, quim201]).
estudiante(2000100904, 1, [ec201, bd101]).
estudiante(2000100905, 0, [moda101, quim101, leng101]).
estudiante(2000100906, 1, [ec201, hist301]).
estudiante(2000100907, 1, [leng101, ofi201, cmpe150]).
estudiante(2000100908, 1, [quim201, math201, hist301]).
estudiante(2000100909, 1, [cmpe150, ec201, bd101, math401]).
%%120
estudiante(2000101000, 1, [soci101, math201]).
estudiante(2000101001, 0, [phis201, quim101]).
estudiante(2000101002, 1, [math401, phis101, quim201, leng101, cmpe150]).
estudiante(2000101003, 1, [phis101, quim201, math201, hist301]).
estudiante(2000101004, 1, [soci101, phis201, ofi201]).
estudiante(2000101005, 1, [soci101, math201]).
estudiante(2000101006, 1, [ec201, bd101, math401]).
estudiante(2000101007, 0, [bd101, math401, phis101]).
estudiante(2000101008, 1, [quim201, math201]).
estudiante(2000101009, 1, [math401, hist301]).
%%130
estudiante(2000102000, 1, [math401, phis201]).
estudiante(2000102001, 1, [leng201, ofi101, quim101, math101, moda101]).
estudiante(2000102002, 1, [moda101, ofi301]).
estudiante(2000102003, 1, [math101, phys201, ec201, hist301, soci101]).
estudiante(2000102004, 0, [soci101, phis201, ofi201]).
estudiante(2000102005, 0, [phys201,hist301]).
estudiante(2000102006, 1, [bd101, math401, ec201, phis101]).
estudiante(2000102007, 0, [ofi301, phys201, bd101, math401]).
estudiante(2000102008, 0, [phis201, quim101]).
estudiante(2000102009, 1, [cmpe150, moda101, ofi101, quim101]).
%%140
estudiante(2000103000, 1, [hist301, cmpe150]).
estudiante(2000103001, 1, [quim101, math101]).
estudiante(2000103002, 0, [cmpe150, math101, phys201]).
estudiante(2000103003, 1, [math101, hist301, cmpe150]).
estudiante(2000103004, 1, [cmpe150, moda101, ofi301]).
estudiante(2000103005, 1, [quim101, math101, hist301]).
estudiante(2000103006, 1, [leng201, ofi101, quim101, math101, hist301]).
estudiante(2000103007, 1, [quim201, math201]).
estudiante(2000103008, 1, [soci101, math201]).
estudiante(2000103009, 1, [math401, phis201]).
%%150
estudiante(2000104000, 1, [math301, bd101, moda101]).
estudiante(2000104001, 1, [math101, phys201, ec201, hist301, soci101]).
estudiante(2000104002, 1, [soci101, math301, leng101, ec201, phis101]).
estudiante(2000104003, 1, [ofi201, quim201, math201]).
estudiante(2000104004, 1, [bd101]).
estudiante(2000104005, 1, [moda101, ofi301]).
estudiante(2000104006, 1, [leng101, ofi201, cmpe150]).
estudiante(2000104007, 0, [cmpe150, math101, phys201]).
estudiante(2000104008, 0, [ofi301, phys201, bd101, math401]).
estudiante(2000104009, 0, [leng201, ofi101, quim101, math101, moda101]).
%%160
estudiante(2000105000, 0, [ofi301, phys201]).
estudiante(2000105001, 1, [math301, bd101, moda101]).
estudiante(2000105002, 1, [cmpe150, ec201, ofi301, phys201]).
estudiante(2000105003, 1, [phys201, soci101, leng201]).
estudiante(2000105004, 1, [math101, moda101, ofi301]).
estudiante(2000105005, 1, [quim101, math101, moda101]).
estudiante(2000105006, 1, [math401, phis101, quim201]).
estudiante(2000105007, 1, [cmpe150, ec201]).
estudiante(2000105008, 1, [math401, phis201]).
estudiante(2000105009, 0, [math301, leng101, cmpe150]).
%%170
estudiante(2000106000, 1, [math201, hist301]).
estudiante(2000106001, 1, [math401, phis201]).
estudiante(2000106002, 1, [cmpe150, math101, phys201]).
estudiante(2000106003, 0, [math101, moda101]).
estudiante(2000106004, 1, [ofi301, phys201]).
estudiante(2000106005, 1, [soci101, phis201, ofi201]).
estudiante(2000106006, 0, [math101, phys201, ec201, hist301, soci101]).
estudiante(2000106007, 1, [math301, bd101, moda101]).
estudiante(2000106008, 1, [ofi301, math401]).
estudiante(2000106009, 1, [phis201, quim101]).



%% --------------------------FECHAS---------------------------------
fechaexam(cmpe150, ['15.04.2018', '25.05.2018', '04.06.2018']).
fechaexam(math101, ['17.04.2018', '15.05.2018', '04.06.2018','08.06.2018']).
fechaexam(phys201, ['15.04.2018', '19.05.2018', '05.06.2018']).
fechaexam(ec201, ['16.04.2018', '20.05.2018', '02.06.2018']).
fechaexam(hist301, ['14.04.2018', '21.05.2018', '01.06.2018']).
fechaexam(soci101, ['01.05.2018', '11.05.2018', '02.06.2018']).
fechaexam(math201, ['18.04.2018', '16.05.2018', '05.06.2018']).
fechaexam(math301, ['04.04.2018', '13.05.2018']).
fechaexam(bd101, ['24.05.2018', '29.05.2018', '31.05.2018']).
fechaexam(moda101, ['10.04.2018']).

fechaexam(leng101, ['01.04.2018', '03.04.2018']).
fechaexam(leng201, ['02.04.2018', '04.04.2018']).
fechaexam(ofi101, ['05.04.2018', '06.04.2018', '13.04.2018']).
fechaexam(ofi201, ['07.04.2018', '14.04.2018']).
fechaexam(ofi301, ['01.05.2018']).
fechaexam(math401, ['06.04.2018','15.04.2018']).
fechaexam(phis101, ['01.05.2018', '02.06.2018', '08.06.2018']).
fechaexam(phis201, ['05.04.2018', '20.04.2018']).
fechaexam(quim101, ['02.04.2018', '26.04.2018', '03.05.2018']).
fechaexam(quim201, ['17.04.2018']).



%% -----------------------PREDICADOS--------------------------------

%% ----------------------PREDICADOS UTILES---------------------------

join([],[]).
join([ID | IDS], F) :- fechaexam(ID, F1), join(IDS, F2), append(F1, F2, F).

tam([],0).
tam([_|Y], R) :- tam(Y, R1), R is R1 + 1.

lista_estudiantes_zurdos(CURSO, ESTUDIANTES):- search(ESTUDIANTE, (estudiante(ESTUDIANTE, 0, CURSOS), member(CURSO, CURSOS)), ESTUDIANTES).
% Nahin: Aqui recibe un conjunto (id de los estudiantes), Metas(una list
% de estudiantes y si el curso ingresado forma parte de los
% suyos(true/false)) y la lista que recibira los estudiantes que llevan
% el ccurso...
% Nahin (clausulas): el primer assera fija encontrar como una lista
% vacia, call llama o establece las metas u objetivos a cumplirse es
% decir: agrega a la lista "encontrar" los estudiantes quienes llevan el
% curso ingresado por el usuario, fail indica que todo esto puede
% fallar, por lo que no es necesario ponerlo, cabe destacar que ese
% conjunto encontrar ya queda en la base para ser llamado por otros
% predicados. se llama a encontrado enviando una lista vacia y la lista
% receptora.
search(Conjunto, Metas, Lista):- asserta( encontrar( [] ) ),
        call(Metas), asserta( encontrar( {Conjunto} ) ), fail;
        encontrados([], Lista).
% en la primera llamada es una lista vacia y Lista la cual recibira los
% ID estudiantes...
% --------------------------------------------------------------------
% Nahin: Aqui recibe dos listas vacias por asi decirlo, retract extrae
% un elemnto de el conjunto encontrar previamente establecido, lo extra
% ya que en la siguiente iteracion no deseamos usarlo de nuevo, el signo
% ! puta idea que es , se vuelve a llamar "encontrados esta vez con
% elemento extraido como parametro, lista vacia Temp y la lista
% receptora"
encontrados(Temp, Lista):- retract( encontrar( Elemento ) ), !, encontrados( Elemento, Temp, Lista).
% Recuerdan asserta(encontrar([]))? pues es una lista vavcia agregada
% junto con el conjunto, cuando se llega a esta lista vacia se devuelve
% la lista de id acumulada.
encontrados([], Lista, Lista).
% Nahin: Aqui recibe el conjunto estudiante (id,zur/der, lista de
% cursos). Cuando se vuelve a llamar, segun yo "[Conjunto|Temp]=[id
% estudiante| resto de informacion que no nos interesa], recuerden que
% Temp=[] lista vacia. Entonces eso se val almcaenando recursivamente."
encontrados({Conjunto}, Temp, Lista):- encontrados([Conjunto|Temp], Lista).

%% --------------------PREDICADOS PROYECTO-----------------------------

%% PREDICADO #1
%% Implemente el predicado lista_estudiantes(id_curso, lista_e). Toma el id del curso y agrega a lista_e los estudiantes que toman el curso.
% ------------------------------------------------------------------------
% nahin: La llamada a search incluye los siguientes parametros: 1.
% ESTUDIANTE: que es ek cojunto o coleccion de IDs de los estudiantes.
% 2-Metas [(estudiante(ESTUDIANTE, _, CURSOS), member(CURSO, CURSOS))]:
% es el conjunto de estudiantes con todos los datos, y el boolean si el
% curso ingresado por el usuario pertenece a los cursos de cada
% estudiante, esto se ocupara mas adelante.
% 3- ESTUDIANTES:Lista receptora donde se guardara los resultados.
lista_estudiantes(CURSO, ESTUDIANTES):- search(ESTUDIANTE, (estudiante(ESTUDIANTE, _, CURSOS), member(CURSO, CURSOS)), ESTUDIANTES).

%% PREDICADO #2
%% Implemente el predicado lista_fechas(id_estudiante, lista_fechas)
%% Toma el id del estudiante y agrega a lista_fechas las fechas de los examenes de los cursos que está tomando
lista_fecha(E, F):- estudiante(E,_,CLASES), join(CLASES, F).

%% PREDICADO #3
%% Implemente el predicado aulas_adecuadas(id_curso, lista_aulas)
%% Toma el id del curso y agrega a lista_aulas, el codigo del aula que
%% tiene la cantidad suficiente de escritorios para izquierdos para ese
%% curso.
aulas_adecuadas(CURSO, AULAS):- search(AULA, (aula(AULA, _, TOTAL_ZURDOS), lista_estudiantes_zurdos(CURSO, ZURDOS), tam(ZURDOS, ZURDOS_CLASE), TOTAL_ZURDOS >= ZURDOS_CLASE), AULAS).

nombre(X):- listar(X).
y(X):- x(_,X).
lista(_,[]).
listar(X):- lista(_,Y) | estudiante(X2,0,_), append([X2],Y, X).














